---
title: 소개
description: Node.js/TypeScript 기반의 풀스택 프레임워크
---

**Sonamu**는 **Node.js**/**TypeScript** 기반의 **풀스택 프레임워크**입니다.

Sonamu는 Fastify 기반의 고성능 백엔드 서버와 엔티티 중심 개발 방식을 통해, 프론트엔드와 백엔드가 타입스크립트라는 동일한 언어를 사용하는 장점을 극대화합니다. E2E Type-safety, 타입 안전 쿼리 빌더(Puri), 자동 마이그레이션, 코드 자동 생성을 통해 반복 작업을 최소화하고 생산성을 높입니다.

## 목적

Sonamu는 아래의 목적에 따라 만들어졌습니다.

- 타입스크립트는 컴파일 타임에만 검증이 가능한데, 런타임에도 타입으로 검증을 수행하고 싶다.
- 프론트엔드와 백엔드 사이의 E2E Type-safety를 보장하고 싶다.
- 강력한 타입 추론을 통해 쿼리 작성 시점부터 타입 안전성을 보장하고 싶다.
- 서브셋을 이용하여 필요한 데이터만 효율적으로 쿼리하고 싶다.
- 기능 추가 시 매번 반복하는 작업을 자동화하고 싶다.
- DB 스키마 변경 시 안전하고 자동화된 마이그레이션을 수행하고 싶다.

### 런타임 타입 검증

타입스크립트는 자바스크립트의 Superset 언어입니다. 타입스크립트의 기능은 컴파일 타임에만 적용될 뿐, 외부 데이터가 전달되는 런타임에는 다른 검증 수단이 있어야 안전하게 요청을 처리할 수 있습니다.

Sonamu는 엔티티 정의를 기반으로 Zod 스키마를 자동 생성하며, `@api` 데코레이터가 적용된 메서드의 파라미터를 자동으로 검증합니다. 이를 통해 API 요청 시 잘못된 타입의 데이터가 전달되는 것을 런타임에 방지할 수 있습니다.

### E2E Type-safety

Sonamu는 단일 소스(엔티티 정의)에서 출발하여 백엔드와 프론트엔드의 타입을 동기화합니다. 엔티티 정의를 기반으로 생성된 타입은 자동으로 프론트엔드 프로젝트로 복사되며, API 메서드의 파라미터와 반환값 타입도 함께 전달됩니다. 이를 통해 API 인터페이스가 변경되면 프론트엔드에서 즉시 타입 오류를 확인할 수 있습니다.

### 타입 안전 쿼리 빌더 (Puri)

Sonamu의 Puri는 완전한 타입 추론을 지원하는 쿼리 빌더입니다. 테이블 스키마를 기반으로 SELECT할 수 있는 컬럼, WHERE 조건에 사용할 수 있는 컬럼, 각 컬럼의 타입까지 모두 TypeScript가 추론합니다. 이를 통해 쿼리 작성 중 오타나 잘못된 타입 사용을 컴파일 타임에 방지할 수 있습니다.

### 서브셋을 사용한 효율적인 데이터 쿼리

서브셋은 엔티티의 사전 정의된 쿼리 패턴입니다. Sonamu UI에서 서브셋을 정의하면, 어떤 컬럼을 SELECT하고, 어떤 테이블과 JOIN하며, 어떤 관계를 로드할지 선언적으로 지정할 수 있습니다. 이를 통해 필요한 데이터만을 효율적으로 가져오고, API마다 일관된 쿼리 패턴을 유지할 수 있습니다.

### 반복 작업 자동화

> _"이런저런 작은 기능 하나 추가해주세요. 간단하죠?"_

작은 기능을 추가하기 위해 우리가 항상 해야하는 작업이 있습니다.

1. **DB 스키마 변경**: 컬럼을 추가하려면 마이그레이션 코드를 작성하고, up/down 테스트를 실행하며, 실 서버에 적용해야 합니다.
2. **모델 코드 작성**: 관련 필드를 다루는 메서드를 추가하고, 타입을 작성하고, 단위테스트를 작성해야 합니다.
3. **API 엔드포인트 추가**: 모델 코드를 외부로 오픈하는 API를 만들고, 필요한 타입과 검증 로직을 작성해야 합니다.
4. **프론트엔드 통합**: API를 호출하는 서비스 코드를 작성하고, 뷰 작업을 수행하며, 타입을 다시 작성해야 합니다.

Sonamu는 위의 각 작업을 자동화합니다:
- Sonamu UI에서 엔티티를 수정하면 마이그레이션 코드가 자동 생성됩니다.
- 엔티티 정의를 기반으로 모델 코드, 타입, 테스트 코드를 스캐폴딩할 수 있습니다.
- `@api` 데코레이터로 API 엔드포인트가 자동 생성되고, 파라미터 검증 로직도 자동으로 추가됩니다.
- API 정의를 기반으로 프론트엔드 서비스 코드와 타입이 자동 생성됩니다.

## 주요 기능

### 백엔드

#### 1. 엔티티 중심 개발
- Sonamu UI를 통한 시각적 엔티티 관리
- 엔티티 정의에서 DB 스키마, 타입, 마이그레이션 코드를 자동 생성
- 엔티티 간 관계(OneToOne, BelongsToOne, HasMany, ManyToMany) 정의 및 자동 쿼리 생성

#### 2. 타입 안전 데이터베이스 레이어
- Puri: 완전한 타입 추론을 지원하는 쿼리 빌더
- UpsertBuilder: 복잡한 관계 데이터를 한 번에 저장하는 헬퍼
- @transactional: 데코레이터 기반의 자동 트랜잭션 관리
- Master/Slave 데이터베이스 구성 지원

#### 3. API 개발
- @api 데코레이터: 모델 메서드를 API 엔드포인트로 자동 변환
- @stream 데코레이터: Server-Sent Events(SSE) 지원
- Zod 기반의 자동 파라미터 검증
- Fastify 기반의 고성능 HTTP 서버

#### 4. 자동 마이그레이션
- 엔티티 정의와 실제 DB 스키마를 비교하여 마이그레이션 코드 자동 생성
- up/down 마이그레이션 지원
- 안전한 스키마 변경 관리

#### 5. 개발 편의 기능
- Hot Module Replacement(HMR): 코드 변경 시 서버 재시작 없이 즉시 반영
- Fixture 관리: 테스트 데이터 관리 및 자동 초기화
- 강력한 CLI 도구

### 프론트엔드

#### 1. E2E 타입 동기화
- 엔티티 정의 기반 타입 자동 동기화
- API 파라미터 및 반환값 타입 동기화
- 컴파일 타임에 API 인터페이스 변경 감지

#### 2. 자동 코드 생성
- API 호출을 위한 서비스 코드 자동 생성
- Axios, SWR, Window Fetch 등 다양한 HTTP 클라이언트 지원
- 엔티티 기반 폼, 리스트, 셀렉트 컴포넌트 스캐폴딩

#### 3. 개발 생산성
- REST Client HTTP 요청 코드 자동 생성
- 타입 안전한 API 호출
- 중복 코드 작성 최소화

## 기술 스택

Sonamu는 검증된 오픈소스 라이브러리들을 기반으로 구축되었습니다.

### 백엔드
- **[Fastify](https://fastify.dev/)**: 고성능 웹 서버 프레임워크
- **[Knex.js](https://knexjs.org/)**: SQL 쿼리 빌더 및 마이그레이션 도구
- **[MySQL2](https://www.npmjs.com/package/mysql2)**: MySQL 데이터베이스 드라이버
- **[Zod](https://zod.dev/)**: TypeScript 타입 스키마 및 런타임 검증 라이브러리

### 프론트엔드
- **[Axios](https://axios-http.com/)**: HTTP 클라이언트 (선택사항)
- **[SWR](https://swr.vercel.app/)**: React Hooks 기반 데이터 페칭 (선택사항)

### 개발 도구
- **TypeScript**: 정적 타입 검사
- **SWC**: 고속 TypeScript 트랜스파일러
- **Chokidar**: 파일 변경 감지 (HMR)

## 개발 워크플로우

Sonamu를 사용한 전형적인 개발 프로세스는 다음과 같습니다:

1. **엔티티 정의**: Sonamu UI에서 테이블 구조와 관계를 정의
2. **마이그레이션**: 자동 생성된 마이그레이션 코드를 실행하여 DB 스키마 업데이트
3. **모델 작성**: 비즈니스 로직을 담은 모델 메서드 구현
4. **API 노출**: `@api` 데코레이터로 모델 메서드를 API로 변환
5. **프론트엔드 통합**: 자동 생성된 서비스 코드를 사용하여 API 호출
6. **UI 구현**: 스캐폴딩된 컴포넌트를 기반으로 사용자 인터페이스 구현

모든 단계에서 타입 안전성이 보장되며, 변경 사항은 실시간으로 반영(HMR)됩니다.
